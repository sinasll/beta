<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>$BLACK</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <!-- Telegram WebApp SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body>

  <div class="header">
    <h1 class="logo">$BLACK</h1>
  </div>

  <div class="container">
    <div class="card global-stats">
      <div class="stats-row">
        <div>Total Mined</div>
        <div><span id="mined">0.00</span> / 100,000,000 $BLACK</div>
      </div>
      <div class="stats-row">
        <div>Total Miners</div>
        <div><span id="totalminers">0</span></div>
      </div>
      <div class="stats-row">
        <div>Active Miners</div>
        <div><span id="totalminers">0</span></div>
      </div>
    </div>

    <div class="card">
      <h2 class="card-title">User</h2>
      <div class="stats-row">
        <div>Username</div>
        <div><span id="username">username</span></div>
      </div>
      <div class="stats-row">
        <div>Balance</div>
        <div><span id="balance">0.000</span> $BLACK</div>
      </div>
      <div class="stats-row">
        <div>Mining Power</div>
        <div>x<span id="power">1.0</span></div>
      </div>
      <button class="button" id="upgradeButton">Upgrade Power</button>
      <button class="button" id="mineButton">Start Mining</button>
    </div>

    <div class="card">
      <div class="stats-row">
        <h2 class="card-title">Daily Code</h2>
      <div><span id="dailyCode">12Fgh90Bvv</span></div>
      </div>
      <button class="button" id="copyCodeButton">Copy Code</button>
      <input type="text" id="submitCodeInput" placeholder="Enter 10-digit code" maxlength="10">
      <button class="button" id="submitCodeButton">Submit Code</button>
    </div>

    <div class="countdown" id="countdown">Daily reset in 00:00:00</div>
  </div>

 <!-- Upgrade Power Modal -->
<div class="modal-overlay" id="upgradeModal">
  <div class="modal">
    <div class="modal-header">
      <h3 class="modal-title">Upgrade Mining Power</h3>
      <button class="modal-close" id="closeModal">&times;</button>
    </div>
    
    <div class="power-option">
      <div class="power-info">
        <div class="power-name">Advanced Miner</div>
        <div class="power-desc">2x mining acceleration</div>
        <div class="power-price"><i class="fas fa-star"></i> 250 Stars</div>
      </div>
      <button class="power-buy" data-power="2" data-price="250">Upgrade</button>
    </div>
    
    <div class="power-option premium">
      <div class="power-info">
        <div class="power-badge">RECOMMENDED</div>
        <div class="power-name">Pro Miner</div>
        <div class="power-desc">5x mining acceleration</div>
        <div class="power-price"><i class="fas fa-star"></i> 500 Stars</div>
      </div>
      <button class="power-buy premium-btn" data-power="5" data-price="500">Upgrade</button>
    </div>
    
    <div class="power-option elite-highlight">
      <div class="elite-glow"></div>
      <div class="power-info">
        <div class="power-name">Elite Miner</div>
        <div class="power-desc">10x mining acceleration</div>
        <div class="power-price"><i class="fas fa-star"></i> 1000 Stars</div>
      </div>
      <button class="power-buy elite-btn" data-power="10" data-price="1000">Upgrade</button>
    </div>
    
    <div class="power-note">
      <i class="fas fa-info-circle"></i> Higher mining power = More $BLACK per minute
    </div>
  </div>
</div>

  <nav class="nav-menu" id="nav-menu">
    <ul class="nav-list">
      <li><a href="index.html" class="active"></i> MINE</a></li>
      <li><a href="leaders.html"></i> LEADERS</a></li>          
      <li><a href="earn.html"></i> EARN</a></li>
      <li><a href="friends.html"></i> FRIENDS</a></li>
      <li><a href="wallet.html"></i> WALLET</a></li>
    </ul>
  </nav>

  <script>
    // Telegram WebApp initialization
    const tg = window.Telegram?.WebApp;
    
    // Expand the Mini App to full height
    if (tg) {
      tg.expand();
      tg.enableClosingConfirmation();
    }
    
    // Function to generate a random unique username starting with blackminer
    function generateRandomUsername() {
      // Try to get from localStorage first to maintain consistency
      const storedUsername = localStorage.getItem('generatedUsername');
      if (storedUsername) {
        return storedUsername;
      }
      
      // Generate a new one if not found
      const randomSuffix = Math.floor(Math.random() * 10000000).toString().padStart(7, '0');
      const newUsername = `blackminer${randomSuffix}`;
      localStorage.setItem('generatedUsername', newUsername);
      return newUsername;
    }
    
    // Set username from Telegram or generate a random one
    const usernameElement = document.getElementById('username');
    if (tg?.initDataUnsafe?.user?.username) {
      usernameElement.textContent = `@${tg.initDataUnsafe.user.username}`;
    } else {
      usernameElement.textContent = `@${generateRandomUsername()}`;
    }

    // Modal functionality
const upgradeButton = document.getElementById('upgradeButton');
const upgradeModal = document.getElementById('upgradeModal');
const closeModal = document.getElementById('closeModal');
const buyButtons = document.querySelectorAll('.power-buy');
const powerElement = document.getElementById('power');

// Show modal when upgrade button is clicked
upgradeButton.addEventListener('click', () => {
  upgradeModal.classList.add('active');
});

// Hide modal when close button is clicked
closeModal.addEventListener('click', () => {
  upgradeModal.classList.remove('active');
});

// Hide modal when clicking outside
upgradeModal.addEventListener('click', (e) => {
  if (e.target === upgradeModal) {
    upgradeModal.classList.remove('active');
  }
});

// Handle power purchases
buyButtons.forEach(button => {
  button.addEventListener('click', () => {
    const power = button.dataset.power;
    const price = button.dataset.price;
    const powerName = button.closest('.power-option').querySelector('.power-name').textContent;
    
    if (tg) {
      // Open Telegram payment interface
      tg.showPopup({
        title: 'Confirm Purchase',
        message: `Do you want to buy ${powerName} (${power}x power) for ${price} Stars?`,
        buttons: [
          {id: 'cancel', type: 'cancel'},
          {id: 'buy', type: 'default', text: 'Buy'}
        ]
      }, (buttonId) => {
        if (buttonId === 'buy') {
          // Process the purchase
          powerElement.textContent = power;
          localStorage.setItem('miningPower', power);
          
          // Update button states to show purchased status
          buyButtons.forEach(btn => {
            if (btn.dataset.power === power) {
              btn.textContent = 'Purchased';
              btn.disabled = true;
              btn.classList.add('purchased');
            } else {
              btn.textContent = 'Upgrade';
              btn.disabled = false;
              btn.classList.remove('purchased');
            }
          });
          
          // Show success message
          tg.showAlert(`Success! You've unlocked ${powerName} (${power}x power).`);
          
          // Close modal
          upgradeModal.classList.remove('active');
        }
      });
    } else {
      // Fallback for non-Telegram environment
      if (confirm(`Do you want to buy ${powerName} (${power}x power) for ${price} Stars?`)) {
        powerElement.textContent = power;
        localStorage.setItem('miningPower', power);
        
        // Update button states
        buyButtons.forEach(btn => {
          if (btn.dataset.power === power) {
            btn.textContent = 'Purchased';
            btn.disabled = true;
            btn.classList.add('purchased');
          } else {
            btn.textContent = 'Upgrade';
            btn.disabled = false;
            btn.classList.remove('purchased');
          }
        });
        
        upgradeModal.classList.remove('active');
        alert(`Success! You've unlocked ${powerName} (${power}x power).`);
      }
    }
  });
});

// Load saved power on page load (only if it exists and is higher than 1.0)
const savedPower = localStorage.getItem('miningPower');
if (savedPower && parseFloat(savedPower) > 1.0) {
  powerElement.textContent = savedPower;
  
  // Update purchased button state on load
  buyButtons.forEach(btn => {
    if (btn.dataset.power === savedPower) {
      btn.textContent = 'Purchased';
      btn.disabled = true;
      btn.classList.add('purchased');
    }
  });
}

    </script>

</body>

</html>